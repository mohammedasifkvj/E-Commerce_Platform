<%- include("../user_partials/header") %>
<!-- account-mobile -->
<div class="themevale_Mobile themevale_MobileAccount" id="account-mobile">
    <div class="themevale_close2">
        <a href="javascript:void(0)" class="close">&times;<span class="text">close</span></a>
    </div>
    <div id="accountMobile">
            <nav class="navPages-mobile">
<ul class="navPages-list navPages-list--user">
    <li class="navPages-item">
        <p class="navPage-subMenu-title">
            <span class="text">Account</span>
        </p>
    </li>
    <li class="navPages-item">
        <a class="navPage-subMenu-action navPages-action" href="/account"><span class="text">Account</span></a>
    </li>
    <li class="navPages-item">
        <a class="navPage-subMenu-action navPages-action" href="/address"><span class="text">Addresses</span></a>
    </li>
    <li class="navPages-item">
        <a class="navPage-subMenu-action navPages-action" href="/orders"><span class="text">Orders</span></a>
    </li>
    <li class="navPages-item">
        <a class="navPage-subMenu-action navPages-action" href="/wishlist"><span class="text">Wish Lists</span></a>
    </li>
    <li class="navPages-item">
        <a class="navPage-subMenu-action navPages-action" href="/profileSettings"><span class="text">Account Settings</span></a>
    </li>
    <li class="navPages-item">
        <a class="navPage-subMenu-action navPages-action" href="/signOut"><span class="text">Log out</span></a>
    </li>
</ul>
</nav>
    </div>
</div>
<!-- account-mobile -->
        <div class="body" data-currency-code="USD">
     
    <main class="page account-wishlist-details account">
        <ul class="breadcrumbs" itemscope itemtype="http://schema.org/BreadcrumbList">
            <li class="breadcrumb " itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
                    <a href="https://luxwatches-demo-02.mybigcommerce.com/" class="breadcrumb-label" itemprop="item"><span itemprop="name">Home</span></a>
                <meta itemprop="position" content="1" />
            </li>
            <li class="breadcrumb " itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
                    <a href="/account" class="breadcrumb-label" itemprop="item"><span itemprop="name">Your Account</span></a>
                <meta itemprop="position" content="2" />
            </li>
            <li class="breadcrumb is-active" itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
                    <meta itemprop="item" content="https://luxwatches-demo-02.mybigcommerce.com/wishlist.php?action=viewwishlistitems&amp;wishlistid=2">
                    <span class="breadcrumb-label" itemprop="name">View Wishlist</span>
                <meta itemprop="position" content="3" />
            </li>
</ul>
    <div class="container container-smaller">
        <div class="page-content">
            <div class="themevale-heading">
                <h2 class="page-heading">Wish List</h2>
            </div>
            <div class="account">
                <nav class="navBar navBar--sub navBar--account">
                    <ul class="navBar-section">
                        <li class="navBar-item">
                            <a class="navBar-action" href="/account">Account</a>
                         </li>
                         <li class="navBar-item">
                            <a class="navBar-action" href="/address">Addresses</a>
                         </li>
                         <li class="navBar-item">
                             <a class="navBar-action" href="/orders">Orders</a>
                         </li>
                         <li class="navBar-item is-active">Wish Lists</li>
                         <li class="navBar-item">
                             <a class="navBar-action" href="/profileSettings">Account Settings</a>
                         </li>
                     </ul>
                </nav>
                <% if (wishlistItems.length === 0) { %>
                    <h1 class="page-heading" data-cart-page-title> Your Wishlist is Empty</h1>
                <% } else{ %>
                    <ul class="productGrid">
         <% wishlistItems.forEach(item => { %>
            <li class="product">
                <article class="card" data-product-id="161" >
        <figure class="card-figure" data-product-id="161">
            <div class="card-figcaption-top" data-product-id="161">
                   <a class="quickview icon" data-product-id="161">
                        <svg class="icon"><use xlink:href="#icon-quickview"></use></svg>
                        <!-- <span class="text">Quick view</span> -->
                   </a>
            </div>
                        <div class="product-badge new-badge">
                            <span class="text">New</span>
                        </div>
                        <div class="product-badge sale-badge">
                            <span class="text">Sale</span>
                        </div>
             <a href="/product/<%= item.productId._id %>" >
                <div class="card-img-container" data-product-id="161">
                    <img src="<%= item.productId.productImage[0] %>" alt="Item" 
           class="lazyload card-image replace-2x img-responsive"/>
                </div></a> 
    
            <figcaption class="card-figcaption card-show">
                <div class="card-figcaption-body">
                    <div class="card-figcaption2"></div>
                            <div class="card-option-size card_optionSize card-option-size-161">
                                <div class="form-field" data-product-attribute="set-rectangle"></div>
                            </div>
                                <a href="#" data-event-type="product-click" class="button card-figcaption-button themevale_Option" data-product-id="161">Choose Options</a>
    
                </div>
            </figcaption>
            
        </figure>
        <div class="card-body">
                <p class="card-brand" data-test-info-type="brandName"><b><%= item.productId.brand %></b></p>
            <h4 class="card-title">
                <a href="/product/<%= item.productId._id %>"><%= item.productId.productName %></a>
            </h4>
            
            <div class="card-price" data-test-info-type="price">
                    
                <div class="price-section price-section--withoutTax rrp-price--withoutTax" >
                    MRP:
                    <span data-product-rrp-price-without-tax class="price price--rrp"> 
                        <%= item.productId.price %>
                    </span>
                </div>
            <div class="price-section price-section--withoutTax non-sale-price--withoutTax price-none no-retail-price" style="display: none;">
                <span class="non-sale-price-label">Was:</span>
                <span data-product-non-sale-price-without-tax class="price price--non-sale"></span>
            </div>
            <div class="price-section price-section--withoutTax" >
                <span class="price-label" >
                    
                </span>
                <span class="price-now-label" style="display: none;">
                    Now:
                </span>
                <span data-product-price-without-tax class="price price--withoutTax"><%= item.productId.discountPrice %></span>
            </div>
            </div>
                    <div class="card-figcaption2"></div>
                <div class="card-option card_optionImage card-option-161">
                    <div class="form-field" data-product-attribute="swatch"></div>
                </div>
                <!-- /<%= product._id %> -->
            <div class="card-action-bottom  card-show">
                <a href="/product/<%= item.productId._id %>" data-event-type="product-click" class="button card-figcaption-button themevale_Option" data-product-id="161">Choose Options</a>
            </div>
        </div>
    </article>
    <form action="" class="form">
        <input type="button" onclick=" removeProduct('<%= item.productId._id %>')" class="button button--default button--small" value="Remove Item" />
    </form>
        </li>
    <%  } ) %>
</ul>
<% }  %>
            </div>
        </div>
    </div>
</main>    

    <div id="modal" class="modal" data-reveal data-prevent-quick-search-close>
    <a href="#" class="modal-close" aria-label="Close" role="button">
        <span aria-hidden="true">&#215;</span>
    </a>
    <div class="modal-content"></div>
    <div class="loadingOverlay"></div>
</div>
    <div id="alert-modal" class="modal modal--alert modal--small" data-reveal data-prevent-quick-search-close>
    <div class="swal2-icon swal2-error swal2-animate-error-icon"><span class="swal2-x-mark swal2-animate-x-mark"><span class="swal2-x-mark-line-left"></span><span class="swal2-x-mark-line-right"></span></span></div>

    <div class="modal-content"></div>

    <div class="button-container"><button type="button" class="confirm button" data-reveal-close>OK</button></div>
</div>
</div>
<script>
    async function removeProduct(productId) {
    const result = await Swal.fire({
        title: 'Are you sure?',
        text: "You won't be able to revert this!",
        icon: 'warning',
        showCancelButton: true,
        confirmButtonText: 'Yes, remove it!'
    });

    if (result.isConfirmed) {
        const response = await fetch('/removeProduct', {
            method: "DELETE",
            headers: {
                'Content-Type': 'application/json'
            },
            body: JSON.stringify({ productId })
        });

        const result = await response.json();
        if (response.status === 200) {
            // window.location.reload();
            //updateCartUI(result.cartItems);
           (() => {
            location.reload(); // Reload the page to update the cart -Given as IIFE
                })();
        } else {
            Swal.fire({
                icon: "error",
                title: "Error",
                text: result.error || "An error occurred",
                showConfirmButton: true
            });
        }
    }
}
</script>
<%- include("../user_partials/footer") %>